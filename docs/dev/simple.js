(function(){'use strict';var r;function t(a,b,d){120!==b.charCodeAt(0)?a.setAttribute(b,d):109===b.charCodeAt(1)&&108===b.charCodeAt(2)?a.setAttributeNS("http://www.w3.org/XML/1998/namespace",b,d):108===b.charCodeAt(1)&&105===b.charCodeAt(2)?a.setAttributeNS("http://www.w3.org/1999/xlink",b,d):a.setAttribute(b,d)}function u(a,b,d){this.b=a;this.h=b;this.f=null;this.c=d;this.j=this.a=this.g=this.s=this.v=this.l=null}r=u.prototype;r.key=function(a){this.f=a;return this};r.props=function(a){this.c=a;return this};
r.data=function(a){this.c=a;return this};r.style=function(a){this.v=a;return this};r.className=function(a){this.s=a;return this};function v(a,b){a.g=b;return a}r.children=function(a){this.b|=16;this.g=a;return this};function w(a,b){a.b|=48;a.g=b;return a}r.value=function(a){this.b|=128;this.g=a;return this};r.checked=function(a){this.b|=256;this.g=a;return this};function x(a){if(0===(a.b&4)){if(a=a.g,null!==a&&"string"!==typeof a)for(var b=0;b<a.length;b++)x(a[b])}else y(a.j)}
function A(a){if(0===(a.b&4)){if(a=a.g,null!==a&&"string"!==typeof a)for(var b=0;b<a.length;b++)A(a[b])}else a.j.detach()}function B(a){if(0===(a.b&512))if(0!==(a.b&4)){a=a.j;a.i|=1;null!==a.m&&0===(a.i&65536)&&B(a.m);0!==(a.i&2)&&D(a);var b=a.o.J;null!==b&&b(a,a.props,a.state)}else{if(null!==a.g&&(a=a.g,"string"!==typeof a))for(b=0;b<a.length;b++)B(a[b])}else A(a)}
function E(a,b){var d=a.b;0!==(d&1)?a.a=document.createTextNode(a.c):0!==(d&2)?a.a=0===(d&131072)?0===(d&32768)?document.createElement(a.h):document.createElementNS("http://www.w3.org/2000/svg",a.h):a.h.createElement():0===(d&512)&&(b=F(a.h,b,a.c),a.a=b.element,a.j=b)}
function G(a,b){var d,c,e,h,f=a.b,l;if(0!==(f&10)){l=a.a;if(0===(f&262144)){var k=a.c;if(null!==k)for(h=Object.keys(k),d=0,c=h.length;d<c;d++)e=h[d],l[e]=k[e];if(null!==a.l)for(h=Object.keys(a.l),d=0,c=h.length;d<c;d++)e=h[d],t(l,e,a.l[e]);null!==a.v&&(0===(f&32768)?l.style.cssText=a.v:l.setAttribute("style",a.v));null!==a.s&&(0===(f&32768)?l.className=a.s:l.setAttribute("class",a.s))}else 0===(f&8)?a.h.w(l,void 0,a.c):b.o.h.w(l,void 0,a.c);e=a.g;if(null!==e)if(0===(f&4096))if(0===(f&384))if(0===
(f&16))"string"===typeof e?l.textContent=e:H(a,e,null,b);else for(d=0,c=e.length;d<c;d++)H(a,e[d],null,b);else 0!==(a.b&128)?a.a.value=a.g:a.a.checked=a.g;else l.innerHTML=e}else 0!==(f&4)&&I(a.j)}function H(a,b,d,c){a=a.a;null===b.a?(E(b,c),0!==(b.b&4)&&y(b.j),G(b,c),a.insertBefore(b.a,d)):(a.insertBefore(b.a,d),x(b),I(b.j,0===(b.b&1024)?b.c:null))}
function J(a,b,d,c){a=a.a;null===b.a?(E(b,c),0!==(b.b&4)&&y(b.j),G(b,c),a.replaceChild(b.a,d.a)):(a.replaceChild(b.a,d.a),x(b),I(b.j,0===(b.b&1024)?b.c:null));B(d)}function K(a,b){a.a.removeChild(b.a);B(b)}function L(a,b){a.a.textContent="";for(a=0;a<b.length;a++)B(b[a])}
function M(a,b,d){var c=a.a,e=a.b,h;b.a=a.a;if(0!==(e&1))a.c!==b.c&&(a.a.nodeValue=b.c);else if(0!==(e&10)){if(0===(e&262144)){if(a.c!==b.c){h=a.c;var f=b.c,l=Object.keys(h),k,m;for(m=0;m<l.length;m++){k=l[m];var g=f[k];h[k]!==g&&(c[k]=g)}}if(a.l!==b.l)if(0===(a.b&64))for(h=a.l,f=b.l,l=Object.keys(h),m=0;m<l.length;m++)k=l[m],g=f[k],h[k]!==g&&t(c,k,g);else if(h=a.l,f=b.l,null!==h)if(null===f)for(k=Object.keys(h),l=0;l<k.length;l++)c.removeAttribute(k[l]);else{k=Object.keys(h);for(l=0;l<k.length;l++)m=
k[l],f.hasOwnProperty(m)?(g=f[m],h[m]!==g&&t(c,m,g)):c.removeAttribute(m);k=Object.keys(f);for(l=0;l<k.length;l++)m=k[l],h.hasOwnProperty(m)||t(c,m,f[m])}else if(null!==f)for(k=Object.keys(f),l=0;l<k.length;l++)m=k[l],t(c,m,f[m]);a.v!==b.v&&(h=null===b.v?"":b.v,0===(e&32768)?c.style.cssText=h:c.setAttribute("style",h));a.s!==b.s&&(h=null===b.s?"":b.s,0===(e&32768)?c.className=h:c.setAttribute("class",h))}else a.c!==b.c&&(0===(e&8)?a.h.w(c,a.c,b.c):d.o.h.w(c,a.c,b.c));if(0===(a.b&384)){if(a.g!==b.g)if(0===
(a.b&4096))if(c=a.g,b=b.g,0===(a.b&16))null===c?"string"===typeof b?a.a.textContent=b:H(a,b,null,d):null===b?"string"===typeof c?a.a.textContent="":K(a,c):"string"===typeof c?"string"===typeof b?(d=a.a.firstChild)?d.nodeValue=b:a.a.textContent=b:(a.a.textContent="",H(a,b,null,d)):"string"===typeof b?(a.a.textContent=b,B(c)):N(c,b)&&c.f===b.f?M(c,b,d):J(a,b,c,d);else if(null!==c&&0!==c.length)if(null===b||0===b.length)L(a,c);else if(1===c.length&&1===b.length)e=c[0],b=b[0],N(e,b)&&e.f===b.f?M(e,b,
d):J(a,b,e,d);else if(0===(a.b&32)){e=f=0;l=c.length-1;for(h=b.length-1;f<=l&&e<=h;){k=c[f];m=b[e];if(!N(k,m)||k.f!==m.f)break;f++;e++;M(k,m,d)}for(;f<=l&&e<=h;){k=c[l];m=b[h];if(!N(k,m)||k.f!==m.f)break;l--;h--;M(k,m,d)}for(;f<=l&&e<=h;)k=c[f++],m=b[e++],N(k,m)&&k.f===m.f?M(k,m,d):J(a,m,k,d);if(f<=l){do K(a,c[f++]);while(f<=l)}else if(e<=h){c=h+1;c=c<b.length?b[c].a:null;do H(a,b[e++],c,d);while(e<=h)}}else{e=l=0;k=c.length-1;m=b.length-1;f=c[l];h=b[e];var g=c[k],n=b[m],p,z;a:for(;;){for(;f.f===
h.f;){N(f,h)?M(f,h,d):J(a,h,f,d);l++;e++;if(l>k||e>m)break a;f=c[l];h=b[e]}for(;g.f===n.f;){N(g,n)?M(g,n,d):J(a,n,g,d);k--;m--;if(l>k||e>m)break a;g=c[k];n=b[m]}if(g.f===h.f){N(g,h)?M(g,h,d):J(a,h,g,d);a.a.insertBefore(h.a,f.a);k--;e++;if(l>k||e>m)break;g=c[k];h=b[e]}else if(f.f===n.f){N(f,n)?M(f,n,d):J(a,n,f,d);f=m+1;f=f<b.length?b[f].a:null;a.a.insertBefore(n.a,f);l++;m--;if(l>k||e>m)break;f=c[l];n=b[m]}else break}if(l>k)for(f=m+1,f=f<b.length?b[f].a:null;e<=m;)H(a,b[e++],f,d);else if(e>m)for(;l<=
k;)K(a,c[l++]);else{var P=k-l+1,f=m-e+1;h=Array(f).fill(-1);var Q=!1,q=0,C=0;if(4>=f||16>=P*f)for(g=l;g<=k;g++){if(p=c[g],C<f)for(n=e;n<=m;n++)if(z=b[n],p.f===z.f){h[n-e]=g;q>n?Q=!0:q=n;N(p,z)?M(p,z,d):J(a,z,p,d);C++;c[g]=null;break}}else{for(var X=new Map,g=e;g<=m;g++)p=b[g],X.set(p.f,g);for(g=l;g<=k;g++)p=c[g],C<f&&(n=X.get(p.f),void 0!==n&&(z=b[n],h[n-e]=g,q>n?Q=!0:q=n,N(p,z)?M(p,z,d):J(a,z,p,d),C++,c[g]=null))}if(P===c.length&&0===C)for(L(a,c);e<f;)H(a,b[e++],null,d);else{for(g=P-C;0<g;)p=c[l++],
null!==p&&(K(a,p),g--);if(Q){l=h.slice(0);c=[];c.push(0);k=0;for(m=h.length;k<m;k++)if(-1!==h[k])if(g=c[c.length-1],h[g]<h[k])l[k]=g,c.push(k);else{g=0;for(n=c.length-1;g<n;)p=(g+n)/2|0,h[c[p]]<h[k]?g=p+1:n=p;h[k]<h[c[g]]&&(0<g&&(l[k]=c[g-1]),c[g]=k)}g=c.length;for(n=c[g-1];0<g--;)c[g]=n,n=l[n];n=c.length-1;for(g=f-1;0<=g;g--)-1===h[g]?(q=g+e,p=b[q],f=q+1,f=f<b.length?b[f].a:null,H(a,p,f,d)):0>n||g!==c[n]?(q=g+e,p=b[q],f=q+1,f=f<b.length?b[f].a:null,a.a.insertBefore(p.a,f)):n--}else if(C!==f)for(g=
f-1;0<=g;g--)-1===h[g]&&(q=g+e,p=b[q],f=q+1,f=f<b.length?b[f].a:null,H(a,p,f,d))}}}else{if(null!==b)for(e=0;e<b.length;e++)H(a,b[e],null,d)}else c.innerHTML=b.g}else 0!==(e&128)?c.value!==b.g&&(c.value=b.g):c.checked!==b.g&&(c.checked=b.g)}else d=b.j=a.j,0!==(e&2048)&&a.c===b.c||I(d,0===(e&1024)?b.c:void 0)}function N(a,b){return a.b===b.b&&a.h===b.h}function O(){this.u=4;this.B=8;this.b=0;this.h="div";this.J=this.I=this.F=this.A=this.w=this.K=null}
O.prototype.tagName=function(a){this.h=a;"string"!==typeof a&&(this.u|=a.u,this.B|=a.u,this.b|=a.u);return this};O.prototype.canvas=function(){this.u|=65536;this.b|=65536;this.h="canvas";return this};O.prototype.init=function(a){this.A=a;return this};O.prototype.update=function(a){this.w=a;return this};function R(a,b){return new u(2052,a,void 0===b?null:b)}
function F(a,b,d){var c;c=0===(a.b&131072)?0===(a.b&32768)?document.createElement(a.h):document.createElementNS("http://www.w3.org/2000/svg",a.h):a.h.createElement();b=new S(a.u,a,c,b,d);0!==(a.b&1)&&(c.M=b);null!==a.A&&a.A(b,b.props);return b}function S(a,b,d,c,e){this.i=a;this.L=0;this.o=b;this.element=d;this.depth=void 0===c?0:c.depth+1;this.props=void 0===e?null:e;this.state=null;this.m=0===(a&65536)?null:d.getContext("2d");this.D=this.C=null}function T(a){return new u(a.o.B,a.o.h,null)}
S.prototype.update=function(a){I(this,a)};function U(a,b){null===a.m?(b.j=a,b.a=a.element,G(b,a)):M(a.m,b,a);a.m=b}function y(a){V(a);null!==a.m&&0===(a.i&65536)&&x(a.m)}S.prototype.detach=function(){null!==this.m&&0===(this.i&65536)&&A(this.m);D(this)};S.prototype.subscribe=function(a){return a.N(this)};function I(a,b){if(void 0!==b&&0===(a.i&512)){var d=a.props,c=a.o.K;null!==c?c(a,d,b):0===(a.i&4)&&(a.i|=4,W(a));a.props=b}6===(a.i&6)&&(a.o.w(a,a.props,a.state),a.L=Y,a.i&=-133)}
function V(a){a.i|=2;var b=a.o.F;null!==b&&b(a,a.props,a.state)}function D(a){a.i&=-19;for(var b=a.C;null!==b;)b.G(),b=b.H;a.C=null;W(a);b=a.o.I;null!==b&&b(a,a.props,a.state)}function W(a){for(var b=a.D;null!==b;)b.G(),b=b.H;a.D=null}function aa(){var a=document.querySelector("#App"),b=F(ba,void 0,null);a.appendChild(b.element);V(b);I(b);return b}var Y=0,Z=[],ca=[],da=document.createTextNode(""),ea="__kivi"+Math.random();(new MutationObserver(fa)).observe(da,{characterData:!0});
window.addEventListener("message",ga);function ga(a){if(a.source===window&&a.data===ea){a=ca;ca=[];for(var b=0;b<a.length;b++)a[b]();Y++}}function fa(){for(;0<Z.length;){var a=Z;Z=[];for(var b=0;b<a.length;b++)a[b]();Y++}}
var ha=(new O).tagName("td").init(function(a,b){a.state=function(a){console.log("Click",b);a.stopPropagation()}}).update(function(a,b,d){U(a,v(T(a).props({onclick:d}).className("TableCell"),b))}),ia=(new O).tagName("tr").update(function(a,b){for(var d=b.props,c="#"+b.id,c=[new u(4,ha,void 0===c?null:c)],e=0;e<d.length;e++)c.push(R(ha,d[e]));d=T(a);d.l={"data-id":b.id};U(a,d.className(b.active?"TableRow active":"TableRow").children(c))}),ja=(new O).tagName("table").update(function(a,b){var d=b.items;
b=Array(d.length);for(var c=0;c<d.length;c++){var e=d[c];b[c]=R(ia,e).key(e.id)}d=T(a).className("Table");U(a,v(d,w(new u(2,"tbody",null),b)))}),ka=(new O).update(function(a,b){var d=b.time;b=b.id;var c=T(a).className("AnimBox");c.l={"data-id":""+b};U(a,c.style("border-radius:"+d%10+"px;background:rgba(0,0,0,"+(.5+d%10/10)+")"))}),la=(new O).update(function(a,b){for(var d=b.items,c=Array(d.length),e=0;e<d.length;e++){var h=d[e];c[e]=R(ka,h).key(h.id)}U(a,w(T(a).className("Anim"),b.items.map(function(a){return R(ka,
a).key(a.id)})))}),ma=(new O).tagName("li").update(function(a,b){U(a,v(T(a).className("TreeLeaf"),""+b.id))}),na=(new O).tagName("ul").update(function(a,b){b=b.children;for(var d=Array(b.length),c=0;c<b.length;c++){var e=b[c];d[c]=e.container?R(na,e).key(e.id):R(ma,e).key(e.id)}U(a,w(T(a).className("TreeNode"),d))}),oa=(new O).update(function(a,b){U(a,v(T(a).className("Tree"),R(na,b.root)))}),ba=(new O).update(function(a,b){var d=b&&b.location,c=null;"table"===d?c=R(ja,b.table):"anim"===d?c=R(la,
b.anim):"tree"===d&&(c=R(oa,b.tree));U(a,v(T(a).className("Main"),c))});uibench.init("kivi[simple]","1.0.0");document.addEventListener("DOMContentLoaded",function(){var a=aa();uibench.run(function(b){a.update(b)},function(b){document.body.innerHTML="<pre>"+JSON.stringify(b,null," ")+"</pre>";a=null})});}).call(window);
